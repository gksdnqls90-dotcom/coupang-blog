<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <title>icbhplus · 쿠팡 추천 리스트 자동 모음</title>
  <meta name="description" content="쿠팡 파트너스 추천 상품 키워드 모음" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
      margin: 0;
      padding: 32px;
      background: #020817;
      color: #e5e7eb;
    }

    header.wrap {
      max-width: 1080px;
      margin: 0 auto 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
    }

    .topbar {
      font-size: 11px;
      color: #64748b;
      margin-bottom: 4px;
    }

    h1 {
      margin: 0 0 8px;
      font-size: 28px;
    }

    p.sub {
      margin: 0;
      font-size: 13px;
      color: #9ca3af;
    }

    .admin-link {
      font-size: 12px;
      color: #a5b4fc;
      text-decoration: none;
      border: 1px solid rgba(129, 140, 248, 0.5);
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.8);
    }

    .admin-link:hover {
      background: rgba(79, 70, 229, 0.3);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 14px;
      max-width: 1080px;
      margin: 0 auto;
    }

    .card {
      position: relative;
      background: #111827;
      border-radius: 16px;
      padding: 14px;
      border: 1px solid rgba(148, 163, 253, 0.16);
      box-shadow: 0 16px 40px rgba(15, 23, 42, 0.55);
      transition: all 0.18s ease;
      cursor: pointer;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 24px 55px rgba(15, 23, 42, 0.9);
      border-color: #38bdf8;
    }

    .card-title {
      font-size: 16px;
      margin: 0 0 6px;
      color: #e5e7eb;
    }

    .card-link {
      font-size: 13px;
      color: #38bdf8;
      text-decoration: none;
    }

    .badge {
      display: inline-block;
      margin-top: 4px;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 10px;
      background: rgba(56, 189, 248, 0.12);
      color: #38bdf8;
    }

    .empty {
      max-width: 1080px;
      margin: 40px auto;
      font-size: 13px;
      color: #9ca3af;
    }
  </style>
</head>

<body>
  <header class="wrap">
    <div>
      <div class="topbar">icbhplus · 쿠팡 추천 포털</div>
      <h1>쿠팡 추천 리스트</h1>
      <p class="sub">관리자 페이지에서 키워드를 추가하면 이곳에 자동으로 카드가 생성됩니다.</p>
    </div>
    <a href="/admin.html" class="admin-link">관리자 페이지 →</a>
  </header>

  <main class="grid" id="cards"></main>
  <div class="empty" id="emptyMsg" style="display:none;">
    아직 등록된 키워드가 없습니다. 관리자 페이지에서 첫 키워드를 추가해 보세요.
  </div>

  <script>
    const API_BASE = '/.netlify/functions';
    const cardsEl = document.getElementById('cards');
    const emptyMsgEl = document.getElementById('emptyMsg');

    function createCard(item) {
      const article = document.createElement('article');
      article.className = 'card';

      const linkHref = `/live/${item.slug}`;

      article.innerHTML = `
        <div class="card-title">${item.keyword}</div>
        <a class="card-link" href="${linkHref}" target="_blank" rel="noopener noreferrer">
          바로 보기 →
        </a>
        <div class="badge">실시간 생성</div>
      `;

      article.addEventListener('click', (e) => {
        if (e.target.tagName.toLowerCase() !== 'a') {
          window.open(linkHref, '_blank');
        }
      });

      return article;
    }

    async function loadKeywords() {
      try {
        const res = await fetch(`${API_BASE}/getKeywords`);
        const list = await res.json();
        cardsEl.innerHTML = '';

        if (!list.length) {
          emptyMsgEl.style.display = 'block';
          return;
        }
        emptyMsgEl.style.display = 'none';

        list.forEach((item) => {
          cardsEl.appendChild(createCard(item));
        });
      } catch (e) {
        console.error(e);
        emptyMsgEl.style.display = 'block';
        emptyMsgEl.textContent = '키워드를 불러오는 중 오류가 발생했습니다.';
      }
    }

    loadKeywords();
  </script>
</body>

</html>